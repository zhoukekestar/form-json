<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>methods</title>
    <script src='../src/form-json.js'></script>
  </head>
  <body>
    <form action='./server.json' enctype="application/form-json" method="post">
      <input name='a' value='b' />
      <input type='submit' />
    </form>

    <script>
      var form = document.querySelector('form');

      form.beforeSend = function (xhr) {
        xhr.setRequestHeader('Access-Token', 'ABC');
      }

      form.beforeStringify = function (data) {
        data.beforeStringify = true;
        return data;
      }
      /**
       * POST data:
       * {
       *  "a": "b",
       *  "beforeStringify": true
       * }
       */
      form.onsuccess = function (data) {
        console.log('response:' + JSON.stringify(data));
      }
    </script>
  </body>
</html>
